# 豆包API集成指南

## 概述

应用已成功集成豆包API，现在可以使用字节跳动的豆包大模型来生成页面使用说明。

## API配置信息

### 默认配置
- **API地址**: `https://ark.cn-beijing.volces.com/api/v3`
- **模型**: `doubao-1-5-thinking-pro-250415`
- **API密钥**: `0bf1c076-b6e9-479a-9c55-051813ad5e4a`

### 支持的API类型
1. **豆包 (推荐)** - 字节跳动豆包大模型
2. **Ollama** - 本地部署的开源模型
3. **OpenAI** - OpenAI GPT系列模型

## 使用方法

### 1. 启动应用
```bash
npm start
```

### 2. 配置API设置
1. 点击工具栏的"设置"按钮
2. 在"AI模型配置"部分：
   - **API类型**: 选择"豆包 (推荐)"
   - **模型服务地址**: `https://ark.cn-beijing.volces.com/api/v3`
   - **API密钥**: `0bf1c076-b6e9-479a-9c55-051813ad5e4a`
   - **模型名称**: `doubao-1-5-thinking-pro-250415`

### 3. 测试连接
1. 点击"测试连接"按钮
2. 如果配置正确，应该显示"连接成功"
3. 状态栏中的"AI: 已连接"指示器会变绿

### 4. 生成页面说明
1. 在浏览器中访问任何网页（默认是百度首页）
2. 等待页面完全加载
3. 点击右下角的悬浮按钮（🤖 生成说明）
4. AI将自动分析页面内容并生成详细的使用说明

## API调用示例

### 请求格式
```bash
curl https://ark.cn-beijing.volces.com/api/v3/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer 0bf1c076-b6e9-479a-9c55-051813ad5e4a" \
  -d '{
    "model": "doubao-1-5-thinking-pro-250415",
    "messages": [
      {"role": "system","content": "你是一个专业的网页分析助手。"},
      {"role": "user","content": "请分析这个网页..."}
    ]
  }'
```

### 响应格式
```json
{
  "choices": [
    {
      "message": {
        "content": "这是生成的页面使用说明..."
      }
    }
  ],
  "model": "doubao-1-5-thinking-pro-250415"
}
```

## 技术实现

### 1. API适配器
应用中的 `ModelAPI` 类支持多种API格式：
- 自动检测API类型
- 统一的请求/响应处理
- 错误处理和重试机制

### 2. 请求构建
```javascript
// 豆包API请求格式
{
  model: "doubao-1-5-thinking-pro-250415",
  messages: [
    {
      role: "system",
      content: "你是一个专业的网页分析助手..."
    },
    {
      role: "user", 
      content: "请分析以下网页内容..."
    }
  ]
}
```

### 3. 响应解析
```javascript
// 从豆包API响应中提取内容
if (response.choices && response.choices.length > 0) {
  content = response.choices[0].message.content;
}
```

## 功能特性

### ✅ 已实现功能
- 豆包API完整集成
- 多API类型支持（豆包/Ollama/OpenAI）
- 自动API类型切换
- 连接状态测试
- 错误处理和重试
- 用户友好的设置界面

### 🔄 工作流程
1. **页面分析**: 自动提取HTML、CSS、JavaScript代码
2. **截图捕获**: 获取页面视觉信息
3. **数据整合**: 将代码和截图信息整合
4. **AI分析**: 发送到豆包API进行智能分析
5. **结果展示**: 格式化显示生成的使用说明

## 故障排除

### 常见问题

1. **连接失败**
   - 检查网络连接
   - 验证API密钥是否正确
   - 确认API地址格式正确

2. **API密钥错误**
   - 确保使用正确的密钥：`0bf1c076-b6e9-479a-9c55-051813ad5e4a`
   - 检查密钥是否有效且未过期

3. **模型不可用**
   - 确认模型名称：`doubao-1-5-thinking-pro-250415`
   - 检查模型是否在当前API密钥下可用

4. **请求超时**
   - 检查网络连接稳定性
   - 尝试减少输入内容长度

### 调试信息
- 打开浏览器开发者工具查看控制台日志
- 检查网络请求是否成功发送
- 查看错误响应的详细信息

## 性能优化

### 1. 内容截断
- 自动截断过长的HTML/CSS/JS内容
- 避免超出API的token限制
- 保留最重要的页面信息

### 2. 请求优化
- 实现请求重试机制
- 设置合理的超时时间
- 缓存API响应结果

### 3. 用户体验
- 实时显示处理进度
- 提供详细的错误信息
- 支持取消正在进行的请求

## 扩展功能

### 未来改进方向
1. **多模型支持**: 支持更多豆包模型变体
2. **批量处理**: 支持批量分析多个页面
3. **自定义提示词**: 允许用户自定义分析提示
4. **结果缓存**: 缓存分析结果避免重复请求
5. **导出功能**: 支持多种格式的结果导出

## 总结

豆包API已成功集成到应用中，提供了强大的AI驱动页面分析功能。用户可以：

- ✅ 使用预配置的豆包API密钥
- ✅ 一键测试API连接
- ✅ 自动生成详细的页面使用说明
- ✅ 享受流畅的用户体验

应用现在具备了完整的AI分析能力，可以为任何网页生成专业的使用说明文档！
